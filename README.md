# Домашнее задание «Базы данных, их типы»
*Асадбеков Асадбек*

## Задание 1. СУБД

### Кейс

Крупная строительная компания, которая также занимается проектированием и девелопментом, решила создать правильную архитектуру для работы с данными. Ниже представлены задачи, которые необходимо решить для каждой предметной области.

Какие типы СУБД, на ваш взгляд, лучше всего подойдут для решения этих задач и почему?

1.1. Бюджетирование проектов с дальнейшим формированием финансовых аналитических отчётов и прогнозирования рисков. СУБД должна гарантировать целостность и чёткую структуру данных.

1.1.* Хеширование стало занимать длительно время, какое API можно использовать для ускорения работы?

1.2. Под каждый девелоперский проект создаётся отдельный лендинг, и все данные по лидам стекаются в CRM к маркетологам и менеджерам по продажам. Какой тип СУБД лучше использовать для лендингов и для CRM? СУБД должны быть гибкими и быстрыми.

1.2.* Можно ли эту задачу закрыть одной СУБД? И если да, то какой именно СУБД и какой реализацией?

1.3. Отдел контроля качества решил создать базу по корпоративным нормам и правилам, обучающему материалу и так далее, сформированную согласно структуре компании. СУБД должна иметь простую и понятную структуру.

1.3.* Можно ли под эту задачу использовать уже существующую СУБД из задач выше и если да, то как лучше это реализовать?

1.4. Департамент логистики нуждается в решении задач по быстрому формированию маршрутов доставки материалов по объектам и распределению курьеров по маршрутам с доставкой документов. СУБД должна уметь быстро работать со связями.

1.4.* Можно ли к этой СУБД подключить отдел закупок или для них лучше сформировать свою СУБД в связке с СУБД логистов?

1.5.* Можно ли все перечисленные выше задачи решить, используя одну СУБД? Если да, то какую именно?

*Приведите ответ в свободной форме.*

#### Ответы:

**1.1. Бюджетирование проектов, финансовые отчёты и прогнозирование рисков**

Для этой задачи требуется СУБД, которая гарантирует целостность данных, поддерживает сложные транзакции и обеспечивает чёткую структуру.
**Рекомендуемая СУБД:** Реляционная СУБД (например, **PostgreSQL** или **MySQL**).

- Реляционные СУБД идеально подходят для работы с финансовыми данными, так как поддерживают ACID-транзакции (атомарность, согласованность, изолированность, долговечность).
- Они обеспечивают строгую структуру данных, что важно для бюджетирования и отчётности.
- Поддерживают сложные запросы и аналитику.

*1.1. Хеширование стало занимать длительное время*
Для ускорения работы можно использовать API для работы с кэшированием, например:
**Redis** (как in-memory key-value хранилище) для кэширования часто запрашиваемых данных.
**Memcached** для распределённого кэширования.

**1.2. Лендинги и CRM**
Для лендингов и CRM требуется гибкость и высокая скорость работы с данными.

**Рекомендуемые СУБД:**
- Для лендингов: **MongoDB** (документоориентированная NoSQL СУБД). Лендинги часто требуют хранения данных в виде JSON-документов, что удобно для MongoDB.
- Для CRM: **PostgreSQL** или **Cassandra** (в зависимости от масштаба). PostgreSQL подходит для сложных запросов и интеграций, а Cassandra — для высоконагруженных систем с большим объёмом данных.

*1.2. Можно ли закрыть задачу одной СУБД?*
Да, можно использовать **PostgreSQL** с поддержкой JSONB для хранения данных лендингов и CRM. Это позволит объединить обе задачи в одной СУБД, сохраняя гибкость и производительность.

**1.3. База корпоративных норм, правил и обучающих материалов**
Для этой задачи требуется СУБД с простой и понятной структурой.
**Рекомендуемая СУБД:** Реляционная СУБД (например, **PostgreSQL** или **SQLite**).

- Реляционные СУБД легко структурируют данные, что важно для хранения нормативных документов и обучающих материалов.
- Поддерживают полнотекстовый поиск, что полезно для работы с большими объёмами текстовой информации.

*1.3. Можно ли использовать существующую СУБД?*
Да, можно использовать ту же СУБД, что и для бюджетирования (например, **PostgreSQL**). Это упростит интеграцию и управление данными. Для реализации нужно создать отдельные таблицы или схемы для хранения корпоративных норм и обучающих материалов.

**1.4. Логистика: маршруты доставки и распределение курьеров**
Для задач логистики требуется СУБД, которая быстро работает со связями и поддерживает геопространственные данные.
**Рекомендуемая СУБД: PostgreSQL** с расширением **PostGIS**.

PostGIS добавляет поддержку геопространственных данных, что необходимо для построения маршрутов.
PostgreSQL поддерживает сложные запросы и связи между объектами.

*1.4. Можно ли подключить отдел закупок?*
Да, можно использовать ту же СУБД (**PostgreSQL**), создав отдельные таблицы или схемы для отдела закупок. Это позволит интегрировать данные логистики и закупок, упростив управление цепочками поставок.

**1.5. Можно ли все задачи решить одной СУБД?**
Да, можно использовать PostgreSQL для всех задач.

- PostgreSQL поддерживает реляционные данные, JSONB для гибкости, геопространственные данные (с PostGIS) и сложные транзакции.
- Это универсальная СУБД, которая может масштабироваться под разные задачи.
- Использование одной СУБД упростит интеграцию данных между отделами и снизит затраты на поддержку.

**Выводы:**

- **PostgreSQL** — основная СУБД для бюджетирования, CRM, корпоративных норм и логистики.
- **MongoDB** — для лендингов, если требуется высокая гибкость.
- **Redis** — для кэширования и ускорения работы с данными.
- **PostGIS** — для геопространственных данных в логистике.

Если компания стремится к унификации, **PostgreSQL** может стать единым решением для всех задач.

## Задание 2. Транзакции

2.1. Пользователь пополняет баланс счёта телефона, распишите пошагово, какие действия должны произойти для того, чтобы транзакция завершилась успешно. Ориентируйтесь на шесть действий.

2.1.* Какие действия должны произойти, если пополнение счёта телефона происходило бы через автоплатёж?

*Приведите ответ в свободной форме.*

#### Ответы:

**2.1. Пополнение баланса телефона: пошаговый процесс транзакции**

Процесс из шести действий:

**1. Инициализация транзакции**
- Пользователь отправляет запрос на пополнение (сумма пополнения, номер телефона).
- Запускается транзакция в системе.

**2. Проверка данных**
- Проверяется валидность номера телефона.
- Проверяется наличие достаточных средств на счёте пользователя (в случае привязки к банковской карте или кошельку).

**3. Резервирование средств**
- Средства временно блокируются (резервируются) на счёте пользователя.
- Система помечает их как "ожидающие списания".

**4. Пополнение баланса телефона**
- В системе оператора связи (телеком) увеличивается баланс указанного номера телефона на сумму пополнения.
- Фиксируется операция в базе данных оператора.

**5. Подтверждение и фиксация транзакции**
- Списываются средства с резервного счёта пользователя.
- В базе данных платежной системы обновляется статус транзакции на "успешно завершено".
- Создаётся запись о выполненной операции.

**6. Завершение транзакции**
- Транзакция фиксируется (коммит).
- Пользователь получает уведомление о выполнении пополнения (например, SMS или пуш-уведомление).

*Если на любом из этапов происходит ошибка (например, недостаточно средств или ошибка на стороне оператора связи), транзакция откатывается (ROLLBACK), и все изменения отменяются.*

**2.1. *Пополнение через автоплатёж**
При автоплатеже процесс практически идентичен, но с некоторыми дополнениями:

**1. Инициализация транзакции (запуск автоплатежа)**
- Автоплатёж запускается либо по расписанию, либо при достижении заданного порога баланса.

**2. Проверка условий автоплатежа**
- Система проверяет, соответствует ли баланс телефона условиям автоплатежа (например, баланс ниже установленного порога).
- Проверяется активность автоплатежа (например, истечение срока действия настройки).

**3. Проверка данных**
- Проверяется номер телефона и достаточность средств на привязанной карте/счёте пользователя.

**4. Резервирование и списание средств**
- Средства блокируются и списываются с привязанной карты/счёта пользователя.

**5. Пополнение баланса телефона**
- Баланс телефона увеличивается, как и при обычной транзакции.
- Фиксируется операция в базе оператора связи.

**6. Уведомление пользователя**
- Пользователь получает уведомление о выполнении автоплатежа.
- Транзакция фиксируется в системе (коммит).

**Особенности автоплатежа:**
- Если автоплатёж настроен через сторонний банк, может быть задействован дополнительный шаг с подтверждением (например, через 3D-Secure).
- Настройки автоплатежа хранятся в отдельной базе данных или таблице.

**Отмена и ошибки:** Если на каком-либо этапе происходит сбой (например, недостаточно средств или автоплатёж отключён), транзакция откатывается, и пользователь получает уведомление об ошибке.

## Задание 3. SQL vs NoSQL

3.1. Напишите пять преимуществ SQL-систем по отношению к NoSQL.

3.1.* Какие, на ваш взгляд, преимущества у NewSQL систем перед SQL и NoSQL.

*Приведите ответ в свободной форме.*

#### Ответы:

## 3.1. Пять преимуществ SQL-систем по отношению к NoSQL:##
1. Строгая структура данных:
- SQL-системы используют реляционную модель, которая требует чёткого определения структуры данных (таблицы, строки, столбцы). Это обеспечивает целостность данных и упрощает их анализ.
- Пример: В SQL можно легко создать связи между таблицами с помощью внешних ключей (foreign keys).
2.	Поддержка ACID-транзакций:
o	SQL-системы гарантируют атомарность, согласованность, изоляцию и долговечность транзакций. Это критически важно для финансовых, банковских и других систем, где важна точность данных.
o	Пример: Перевод денег между счетами в банке.
3.	Мощные возможности для аналитики:
o	SQL-системы поддерживают сложные запросы, агрегацию данных, оконные функции и соединения (JOIN), что делает их идеальными для аналитики и отчётности.
o	Пример: Получение отчёта о продажах за последний год с разбивкой по регионам.
4.	Широкие возможности для интеграции:
o	SQL-системы имеют стандартизированный язык запросов (SQL), что упрощает интеграцию с другими системами и инструментами.
o	Пример: Подключение к SQL-базе данных из BI-инструментов (например, Tableau или Power BI).
5.	Зрелость и надёжность:
o	SQL-системы существуют десятилетия, имеют огромное сообщество, хорошо документированы и протестированы. Это делает их надёжными и предсказуемыми.
o	Пример: PostgreSQL, MySQL, Oracle.
________________________________________
3.1. Преимущества NewSQL систем перед SQL и NoSQL:*
NewSQL — это современные системы, которые сочетают преимущества SQL (ACID-транзакции, строгая структура) и NoSQL (горизонтальная масштабируемость, высокая производительность). Вот их ключевые преимущества:
1.	Горизонтальная масштабируемость:
o	NewSQL системы, такие как CockroachDB или Google Spanner, поддерживают горизонтальное масштабирование, что позволяет обрабатывать большие объёмы данных и высокие нагрузки.
o	Пример: Распределённая база данных, которая может работать на сотнях серверов.
2.	Поддержка ACID-транзакций в распределённых системах:
o	В отличие от NoSQL, NewSQL гарантирует ACID-транзакции даже в распределённых средах.
o	Пример: Финансовые операции в глобальной системе с низкой задержкой.
3.	Высокая производительность:
o	NewSQL системы оптимизированы для работы с большими объёмами данных и высокими нагрузками, сохраняя при этом преимущества SQL.
o	Пример: Обработка миллионов транзакций в секунду.
4.	Совместимость с SQL:
o	NewSQL системы поддерживают стандартный SQL, что упрощает миграцию с традиционных SQL-систем.
o	Пример: Использование привычных SQL-запросов в CockroachDB.
5.	Упрощённое управление:
o	NewSQL системы часто имеют встроенные механизмы для автоматического шардирования, репликации и восстановления после сбоев.
o	Пример: Автоматическое распределение данных по кластерам в Google Spanner.
6.	Гибридный подход:
o	NewSQL сочетает строгую структуру SQL и гибкость NoSQL, что позволяет использовать их в различных сценариях.
o	Пример: Хранение структурированных данных с возможностью масштабирования, как в NoSQL.



## Задание 4. Кластеры

Необходимо производить большое количество вычислений при работе с огромным количеством данных, под эту задачу выделено 1000 машин.

На основе какого критерия будете выбирать тип СУБД и какая модель распределённых вычислений здесь справится лучше всего и почему?

*Приведите ответ в свободной форме.*

#### Ответы:

